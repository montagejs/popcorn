montageDefine("0e99770","cache-worker",{dependencies:[],factory:function(e,n,t){function r(e,n){g&&console.log("OfflineWorker",e,n)}function c(e){return g&&r("postMessage",e),self.clients.matchAll().then(function(n){return Promise.all(n.map(function(n){return n.postMessage(e)}))})}function i(e){var n={rev:"",cache:[],network:[]},t=null;return e.split("\n").forEach(function(e){if(e)if(m.indexOf(e)!==-1)t=e;else if("CACHE MANIFEST"===t)if(0===e.indexOf("#")){var r=String(e||"").split(" ");r[0]&&r[1]&&e.indexOf(r[0])!==-1&&(n.rev+=n[r[0].replace("#")]=r[1])}else n.cache.push(e);else"CACHE:"===t?n.cache.push(e):"NETWORK:"===t&&n.network.push(e)}),r("AppCacheManifest.rev: "+n.rev),n}function u(){return new Promise(function(e,n){r("Fetching cache manifest..."),fetch("./manifest.appcache").then(function(t){r("Fetched cache manifest."),200===t.status?t.text().then(function(n){var t=i(n);e(t)},n):n("NoAppCache")})["catch"](function(e){r("Fetch cache manifest failed cause: "+e),n(e)})})}function o(){return new Promise(function(e,n){var t=indexedDB.open(C,1);t.onupgradeneeded=function(){var e=t.result,n=e.createObjectStore(E,{keyPath:"key"});n.createIndex("KeyIndex",["key"])},t.onblocked=function(e){e.target.result&&e.target.result.close(),n(e.target.error||"OpenBlocked")},t.onerror=function(e){n(e.target.error||"OpenError")},t.onsuccess=function(){e(t.result)}})}function a(e){return o().then(function(n){var t=n.transaction(E,"readwrite"),r=t.objectStore(E);return new Promise(function(n,t){var c=r.get(e);c.onsuccess=function(e){var t=e.target.result;n("undefined"!=typeof t&&"string"==typeof t.value?t.value:null)},c.onerror=function(e){n(e.target.error)}})["finally"](function(){n.close()})})}function s(e,n){return o().then(function(t){var r=t.transaction(E,"readwrite"),c=r.objectStore(E);return new Promise(function(t,r){var i=c.put({key:e,value:n});i.onerror=function(e){t(e.target.error)},i.onsuccess=function(e){t(e.target.result)}})["finally"](function(){t.close()})})}function f(e){return s(y,e)}function l(){return a(y).then(function(e){return caches.has(e).then(function(n){return n===!0?(r("AppCache.rev: "+e),e):null})})}function h(){return caches.keys().then(function(e){return Promise.all(e.map(function(e){return caches["delete"](e)}))})}function d(e,n){return h().then(function(){return caches.open(e).then(function(t){return t.addAll(n).then(function(){return r('Updated cache version "'+e+'" urls ('+n.length+")",n),e})})})}function v(){return p?p:(c("progress"),(p=u()).then(function(e){return l().then(function(n){return null===n?(r('Installing cache "'+e.rev+'"'),d(e.rev,e.cache).then(function(){return r('Installed cache "'+e.rev+'"'),f(e.rev).then(function(){return Promise.resolve("noUpdate")})})):n!==e.rev?(r('Updating to cache "'+e.rev+'"'),d(e.rev,e.cache).then(function(){return r('Updated cache from "'+n+'" to "'+e.rev+'"'),f(e.rev).then(function(){return Promise.resolve("updateReady")})})):(r('Cached "'+e.rev+'"'),Promise.resolve("cached"))})})["finally"](function(){p=null}))}Promise.prototype["finally"]=function(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})};var p,g=!1,m=["CACHE MANIFEST","CACHE:","NETWORK:"],C="OfflineWorker",E="OfflineObjectStore",y="appCacheVersion";r("Started",self),self.addEventListener("install",function(e){r("Install...",e),e.waitUntil(v().then(function(){return r("Installed",self),self.skipWaiting()})["catch"](function(e){return r("No Cache cause: "+e),c("err")}).then(function(){r("Installed",self)}))}),self.addEventListener("activate",function(e){r("Activating...",e),e.waitUntil(v().then(function(e){return self.skipWaiting().then(function(){return c(e)})["catch"](function(e){return r("No Update cause: "+e),c("noUpdate")}).then(function(){return r("Activated",self),clients.claim()})}))}),self.addEventListener("message",function(e){"Update"===e.data?(r("UpdateCache...",e),e.waitUntil(v().then(function(e){return c(e)})["catch"](function(e){return r("No Update cause: "+e),c("error")}))):"CacheClear"===e.data&&(r("CacheClear...",e),e.waitUntil(h().then(function(){return c("CacheCleared")})["catch"](function(e){return r("No cache clear cause: "+e),c("error")})))}),self.addEventListener("sync",function(e){r("Push event received",e)}),self.addEventListener("push",function(e){r("Push event received",e)}),self.addEventListener("update",function(e){r("Update event received",e)}),self.addEventListener("fetch",function(e){e.request.url.startsWith(self.location.origin)&&e.respondWith(caches.match(e.request).then(function(n){return n?(r("Cache hit",e.request.url),n):(r("Cache miss",e.request.url),fetch(e.request))}))})}});