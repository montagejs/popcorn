var Component=require("montage/ui/component").Component,Promise=require("montage/core/promise").Promise;exports.Image=Component.specialize({_src:{value:null},_label:{value:null},src:{set:function(e){e!==this._src&&(this._src=e,this.needsDraw=!0)}},label:{set:function(e){e!==this._label&&(this._label=e,this.needsDraw=!0)}},_loadImage:{value:function(){var e={};return function(t){if(!e.hasOwnProperty(t)){var r=Promise.defer(),n=new Image;n.onload=function(){r.resolve(t)},n.onerror=function(){r.reject(t)},n.src=t,e[t]=r.promise}return e[t]}}()},draw:{value:function(){var e=this,t=e._element;t.setAttribute("title",e._label),t.setAttribute("alt",e._label),e._src?(t.style.backgroundImage="url(assets/image/loading-poster.gif)",t.style.backgroundSize="auto",e._loadImage(e._src).then(function(){t.style.backgroundImage="url("+e._src+")"})["catch"](function(){t.style.backgroundImage="url(assets/image/no-poster.jpg)"})["finally"](function(){t.style.backgroundSize=""})):t.style.backgroundImage="url(assets/image/no-poster.jpg)"}}});