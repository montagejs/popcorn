montageDefine("0e99770","ui/main.reel/main",{dependencies:["montage/ui/component","core/tmdb-service","montage/core/localizer","core/cache-manager.js"],factory:function(e,o,n){var t=e("montage/ui/component").Component,i=e("core/tmdb-service").shared,a=e("montage/core/localizer").defaultLocalizer,c=e("core/cache-manager.js").CacheManager;o.Main=t.specialize({constructor:{value:function(){var e=this.getParameterByName("lang");e&&(a.locale=e),this.application.addEventListener("openTrailer",this,!1),this.canDrawGate.setField("moviesLoaded",!1),this._initialDataLoad=this.moviesService.load(),c.events.error=function(e){console.error("MainUpdate","error",e)},c.events.cached=function(){console.log("MainUpdate","up-to-date (cached)")},c.events.noUpdate=function(){console.log("MainUpdate","up-to-date (noUpdate)")},c.events.checking=function(){console.log("MainUpdate","checking")},c.events.updateReady=function(){console.log("MainUpdate","updateReady")},c.events.noupdate=function(){console.log("MainUpdate","noupdate")},c.confirmOnUpdateReady=!0,c.listenToUpdate(),c.checkForUpdate()}},getParameterByName:{value:function(e,o){o||(o=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),t=n.exec(o);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}},moviesService:{value:i},_initialDataLoad:{value:null},templateDidLoad:{value:function(){var e=this;e._initialDataLoad.then(function(){e.canDrawGate.setField("moviesLoaded",!0)}).done()}},handleOpenTrailer:{value:function(e){var o=e.detail.trailers;if(o&&o.youtube&&o.youtube.length){for(var n,t=o.youtube,i=0,a=t.length;i<a&&(n=t[i],!(n.name&&n.name.toLowerCase().indexOf("official")>-1));i++);this.templateObjects.player.openTrailer(n.source)}}},_windowScroll:{value:function(e){window.innerHeight!==window.outerHeight&&window.innerHeight===this._element.offsetHeight||(window.scrollTo(0,0),e.templateObjects.moviestrip.movieFlow.handleResize(),window.clearTimeout(e._windowScrollTimeout),e._windowScrollTimeout=window.setTimeout(function(){e._windowScroll(e)},700))}},_windowScrollTimeout:{value:null},handleOrientationchange:{value:function(){var e=this;window.scrollTo(0,0),navigator.userAgent.match(/(iPhone|iPod touch);.*CPU.*OS 7_0_\d/i)&&(window.clearTimeout(this._windowScrollTimeout),90===Math.abs(window.orientation)&&(e._windowScrollTimeout=window.setTimeout(function(){e._windowScroll(e)},1e3)))}},enterDocument:{value:function(e){e&&window.addEventListener("orientationchange",this,!1)}}})}});