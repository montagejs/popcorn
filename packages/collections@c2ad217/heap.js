function Heap(t,e,n){return this instanceof Heap?(this.contentEquals=e||Object.equals,this.contentCompare=n||Object.compare,this.content=[],this.length=0,void this.addEach(t)):new Heap(t,e,n)}var ArrayChanges=require("./listen/array-changes"),Shim=require("./shim"),GenericCollection=require("./generic-collection"),MapChanges=require("./listen/map-changes"),RangeChanges=require("./listen/range-changes"),PropertyChanges=require("./listen/property-changes");module.exports=Heap,Heap.Heap=Heap,Object.addEach(Heap.prototype,GenericCollection.prototype),Object.addEach(Heap.prototype,PropertyChanges.prototype),Object.addEach(Heap.prototype,RangeChanges.prototype),Object.addEach(Heap.prototype,MapChanges.prototype),Heap.from=GenericCollection.from,Heap.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentCompare)},Heap.prototype.push=function(t){this.content.push(t),this["float"](this.content.length-1),this.length++},Heap.prototype.pop=function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content.set(0,e),this.sink(0)),this.length--,t},Heap.prototype.add=function(t){this.push(t)},Heap.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this.contentEquals(this.content[e],t))return e;return-1},Heap.prototype["delete"]=function(t,e){if(e)throw new Error("Heap#delete does not support second argument: equals");var n=this.indexOf(t);if(n===-1)return!1;var o=this.content.pop();if(this.length=this.content.length,n===this.content.length)return!0;this.content.set(n,o);var i=this.contentCompare(o,t);return i>0?this["float"](n):i<0&&this.sink(n),!0},Heap.prototype.peek=function(){if(this.length)return this.content[0]},Heap.prototype.max=function(){return this.peek()},Heap.prototype.one=function(){return this.peek()},Heap.prototype["float"]=function(t){for(var e=this.content[t];t>0;){var n=Math.floor((t+1)/2)-1,o=this.content[n];if(!(this.contentCompare(o,e)<0))break;this.content.set(n,e),this.content.set(t,o),t=n}},Heap.prototype.sink=function(t){for(var e,n,o,i,r,a,h=this.content.length,p=this.content[t];;){if(i=2*(t+1),o=i-1,a=!1,o<h){var e=this.content[o],s=this.contentCompare(e,p);s>0&&(r=o,a=!0)}if(i<h){var n=this.content[i],s=this.contentCompare(n,a?e:p);s>0&&(r=i,a=!0)}if(!a)break;this.content.set(t,this.content[r]),this.content.set(r,p),t=r}},Heap.prototype.clear=function(){this.content.clear(),this.length=0},Heap.prototype.reduce=function(t,e){var n=arguments[2];return this.content.reduce(function(e,o,i){return t.call(n,e,o,i,this)},e,this)},Heap.prototype.reduceRight=function(t,e){var n=arguments[2];return this.content.reduceRight(function(e,o,i){return t.call(n,e,o,i,this)},e,this)},Heap.prototype.toJSON=function(){return this.toArray()},Heap.prototype.makeObservable=function(){this.content.addRangeChangeListener(this,"content"),this.content.addBeforeRangeChangeListener(this,"content"),this.content.addMapChangeListener(this,"content"),this.content.addBeforeMapChangeListener(this,"content")},Heap.prototype.handleContentRangeChange=function(t,e,n){this.dispatchRangeChange(t,e,n)},Heap.prototype.handleContentRangeWillChange=function(t,e,n){this.dispatchBeforeRangeChange(t,e,n)},Heap.prototype.handleContentMapChange=function(t,e){this.dispatchMapChange(e,t)},Heap.prototype.handleContentMapWillChange=function(t,e){this.dispatchBeforeMapChange(e,t)};