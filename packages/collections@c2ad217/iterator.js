"use strict";function Iterator(t,e){var r=e&&t&&t.values&&t.values();if(r&&"function"==typeof r.next)return r;if(!(this instanceof Iterator))return new Iterator(t);if(Array.isArray(t)||"string"==typeof t)return Iterator.iterate(t);if(t=Object(t),t instanceof Iterator)return t;if(t.next)this.next=function(){return t.next()};else if(t.iterate){var o=t.iterate();this.next=function(){return o.next()}}else{if("[object Function]"!==Object.prototype.toString.call(t))throw new TypeError("Can't iterate "+t);this.next=t}}module.exports=Iterator;var Object=require("./shim-object"),GenericCollection=require("./generic-collection");Iterator.prototype.forEach=GenericCollection.prototype.forEach,Iterator.prototype.map=GenericCollection.prototype.map,Iterator.prototype.filter=GenericCollection.prototype.filter,Iterator.prototype.every=GenericCollection.prototype.every,Iterator.prototype.some=GenericCollection.prototype.some,Iterator.prototype.any=GenericCollection.prototype.any,Iterator.prototype.all=GenericCollection.prototype.all,Iterator.prototype.min=GenericCollection.prototype.min,Iterator.prototype.max=GenericCollection.prototype.max,Iterator.prototype.sum=GenericCollection.prototype.sum,Iterator.prototype.average=GenericCollection.prototype.average,Iterator.prototype.flatten=GenericCollection.prototype.flatten,Iterator.prototype.zip=GenericCollection.prototype.zip,Iterator.prototype.enumerate=GenericCollection.prototype.enumerate,Iterator.prototype.sorted=GenericCollection.prototype.sorted,Iterator.prototype.group=GenericCollection.prototype.group,Iterator.prototype.reversed=GenericCollection.prototype.reversed,Iterator.prototype.toArray=GenericCollection.prototype.toArray,Iterator.prototype.toObject=GenericCollection.prototype.toObject,Iterator.prototype.iterator=GenericCollection.prototype.iterator,Iterator.prototype.__iterationObject=null,Object.defineProperty(Iterator.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:void 0})}}),Iterator.prototype.constructClone=function(t){var e=[];return e.addEach(t),e},Iterator.prototype.mapIterator=function(t){var e=Iterator(this),r=arguments[1],o=0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError;return new e.constructor(function(){if(e._iterationObject.done!==!0){var n=t.call(r,e.next().value,o++,e);e._iterationObject.value=n}return e._iterationObject})},Iterator.prototype.filterIterator=function(t){var e=Iterator(this),r=arguments[1],o=0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError;return new e.constructor(function(){for(var n;;){if(n=e.next(),n.done===!0)return n;if(t.call(r,n.value,o++,e))return n}})},Iterator.prototype.reduce=function(t){var e,r=Iterator(this),o=arguments[1],n=arguments[2],i=0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError;if(e=r.next(),e.done===!0){if(arguments.length>1)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(o=arguments.length>1?t.call(n,o,e.value,i,r):e.value,i++;;){if(e=r.next(),e.done===!0)return o;o=t.call(n,o,e.value,i,r),i++}},Iterator.prototype.concat=function(){return Iterator.concat(Array.prototype.concat.apply(this,arguments))},Iterator.prototype.dropWhile=function(t){var e,r,o=Iterator(this),n=arguments[1],i=!1,a=0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError;for(;;){if(r=o.next(),r.done===!0)break;if(!t.call(n,r.value,a,o)){i=!0,e=r.value;break}a++}return i?o.constructor([e]).concat(o):o.constructor([])},Iterator.prototype.takeWhile=function(t){var e=Iterator(this),r=arguments[1],o=0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError;return new e.constructor(function(){if(e._iterationObject.done!==!0){var n=e.next().value;t.call(r,n,o++,e)?e._iterationObject.value=n:(e._iterationObject.done=!0,e._iterationObject.value=void 0)}return e._iterationObject})},Iterator.prototype.zipIterator=function(){return Iterator.unzip(Array.prototype.concat.apply(this,arguments))},Iterator.prototype.enumerateIterator=function(t){return Iterator.count(t).zipIterator(this)},Iterator.iterate=function(t){var e;return e=0,new Iterator(function(){if("object"==typeof t)for(;!(e in t);){if(e>=t.length){this._iterationObject.done=!0,this._iterationObject.value=void 0;break}e+=1}else e>=t.length&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);return this._iterationObject.done||(this._iterationObject.value=t[e],e+=1),this._iterationObject})},Iterator.cycle=function(t,e){var r;return arguments.length<2&&(e=1/0),new Iterator(function(){var o,n;return r&&(n=r()),r&&n.done!==!0||(e>0?(e--,o=Iterator.iterate(t),n=(r=o.next.bind(o))()):(this._iterationObject.done=!0,n=this._iterationObject)),n})},Iterator.concat=function(t){t=Iterator(t);var e;return new Iterator(function(){var r,o;return e&&(o=e()),o&&o.done!==!0?o:(o=t.next(),o.done===!1?(r=Iterator(o.value),(e=r.next.bind(r))()):o)})},Iterator.unzip=function(t){return t=Iterator(t).map(Iterator),new Iterator(0===t.length?[]:function(){var e,r,o=t.map(function(t){return r=t.next(),r.done===!0&&(e=!0),r.value});return e?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=o,this._iterationObject})},Iterator.zip=function(){return Iterator.unzip(Array.prototype.slice.call(arguments))},Iterator.chain=function(){return Iterator.concat(Array.prototype.slice.call(arguments))},Iterator.range=function(t,e,r){return arguments.length<3&&(r=1),arguments.length<2&&(e=t,t=0),t=t||0,r=r||1,new Iterator(function(){t>=e&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);var o=t;return t+=r,this._iterationObject.value=o,this._iterationObject})},Iterator.count=function(t,e){return Iterator.range(t,1/0,e)},Iterator.repeat=function(t,e){return new Iterator.range(e).mapIterator(function(){return t})};