"use strict";function FastSet(t,e,o,n){if(!(this instanceof FastSet))return new FastSet(t,e,o,n);e=e||Object.equals,o=o||Object.hash,n=n||Function.noop,this.contentEquals=e,this.contentHash=o,this.getDefault=n;var r=this;this.buckets=new this.Buckets(null,function(){return new r.Bucket}),this.length=0,this.addEach(t)}var Shim=require("./shim"),Dict=require("./_dict"),List=require("./_list"),GenericCollection=require("./generic-collection"),GenericSet=require("./generic-set"),TreeLog=require("./tree-log"),object_has=Object.prototype.hasOwnProperty;module.exports=FastSet,FastSet.FastSet=FastSet,Object.addEach(FastSet.prototype,GenericCollection.prototype),Object.addEach(FastSet.prototype,GenericSet.prototype),FastSet.from=GenericCollection.from,FastSet.prototype.Buckets=Dict,FastSet.prototype.Bucket=List,FastSet.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentHash,this.getDefault)},FastSet.prototype.has=function(t){var e=this.contentHash(t);return this.buckets.get(e).has(t)},FastSet.prototype.get=function(t,e){if(e)throw new Error("FastSet#get does not support second argument: equals");var o=this.contentHash(t),n=this.buckets;return n.has(o)?n.get(o).get(t):this.getDefault(t)},FastSet.prototype["delete"]=function(t,e){if(e)throw new Error("FastSet#delete does not support second argument: equals");var o=this.contentHash(t),n=this.buckets;if(n.has(o)){var r=n.get(o);if(r["delete"](t))return this.length--,0===r.length&&n["delete"](o),!0}return!1},FastSet.prototype.clear=function(){this.buckets.clear(),this.length=0},FastSet.prototype.add=function(t){var e=this.contentHash(t),o=this.buckets;return o.has(e)||o.set(e,new this.Bucket(null,this.contentEquals)),!o.get(e).has(t)&&(o.get(e).add(t),this.length++,!0)},FastSet.prototype.reduce=function(t,e){var o=arguments[2],n=this.buckets,r=0;return n.reduce(function(e,n){return n.reduce(function(e,n){return t.call(o,e,n,r++,this)},e,this)},e,this)},FastSet.prototype.one=function(){if(this.length>0)return this.buckets.one().one()},FastSet.prototype.iterate=function(){return this.buckets.valuesArray().flatten().iterate()},FastSet.prototype.log=function(t,e,o,n){t=t||TreeLog.unicodeSharp,e=e||this.logNode,o||(o=console.log,n=console),o=o.bind(n);for(var r,s,i,a,c=this.buckets,u=c.size,h=c.keys(),l=0;r=h.next().value;)l===u-1?(s=t.fromAbove,i=" "):0===l?(s=t.branchDown,i=t.strafe):(s=t.fromBoth,i=t.strafe),a=c.get(r),o.call(n,s+t.through+t.branchDown+" "+r),a.forEach(function(r,s){var c,u,h;s===a.head.prev?(c=t.fromAbove,u=" "):(c=t.fromBoth,u=t.strafe),e(s,function(e){h?o.call(n,i+" "+u+"  "+e):(o.call(n,i+" "+c+t.through+t.through+e),h=!0)},function(e){o.call(n,i+" "+t.strafe+"  "+e)})}),l++},FastSet.prototype.logNode=function(t,e){var o=t.value;Object(o)===o?JSON.stringify(o,null,4).split("\n").forEach(function(t){e(" "+t)}):e(" "+o)};