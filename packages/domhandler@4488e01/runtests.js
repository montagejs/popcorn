function compare(e,r){if(assert.equal(typeof e,typeof r,"types didn't match"),"object"!=typeof e||null===e)assert.strictEqual(e,r,"result doesn't equal expected");else for(var t in e)assert.ok(t in r,"result didn't contain property "+t),compare(e[t],r[t])}var fs=require("fs"),path=require("path"),assert=require("assert"),Parser=require("htmlparser2").Parser,Handler=require("./"),basePath=path.resolve(__dirname,"tests"),chunkSize=5;fs.readdirSync(basePath).filter(RegExp.prototype.test,/\.json$/).map(function(e){return path.resolve(basePath,e)}).map(require).forEach(function(e){console.log("Testing:",e.name);for(var r=new Handler(function(r,t){assert.ifError(r),compare(e.expected,t)},e.options.handler),t=e.html,s=new Parser(r,e.options.parser),a=0;a<t.length;a+=chunkSize)s.write(t.substring(a,a+chunkSize));s.done(),s.parseComplete(t)}),console.log("\nAll tests passed!");