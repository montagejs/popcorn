"use strict";function graphOt(e,t){for(var r,s=(t.length+1)*(e.length+1),n=Array(s),i=Array(t.length+1),l=Array(t.length+1),a=0;a<e.length+1;a++){for(var f=0;f<t.length+1;f++){var p,o;if(0===a&&0===f)p=" ",o=0;else if(0===a)p="insert",o=f;else if(0===f)p="delete",o=a;else if(e[a-1]===t[f-1])p="retain",o=l[f-1];else{var g=i[f-1],h=l[f];h<g?(p="delete",o=h+1):(p="insert",o=g+1)}n[a+f*(e.length+1)]=p,i[f]=o}r=i,i=l,l=r}return{edges:n,cost:l[t.length],source:t,target:e}}function traceOt(e){for(var t,r,s=[],n=e.edges,i=t=e.target.length,l=e.source.length;t||l;){var a=n[t+l*(i+1)];if("delete"===a){if(r&&"delete"===r[0])r[1]++;else{var f=["delete",1];r=f,s.push(f)}t--}else if("insert"===a){if(r&&"insert"===r[0])r[1]++;else{var f=["insert",1];r=f,s.push(f)}l--}else if("retain"===a){var f=["retain",1];r&&"retain"===r[0]?r[1]++:(r=f,s.push(f)),t--,l--}}return s.reverse(),s}function ot(e,t){return traceOt(graphOt(e,t))}function diff(e,t){for(var r=ot(e,t),s=[],n=0,i=0,l=0;l<r.length;){var a=r[l++];if("insert"===a[0])s.push([i,0,t.slice(i,i+a[1])]),i+=a[1];else if("delete"===a[0])if(l<r.length&&"insert"===r[l][0]){var f=r[l++];s.push([i,a[1],t.slice(i,i+f[1])]),n+=a[1],i+=f[1]}else s.push([i,a[1]]),n+=a[1];else"retain"==a[0]&&(n+=a[1],i+=a[1])}return s}function apply(e,t){for(var r=0;r<t.length;r++)e.swap.apply(e,t[r])}function merge(e,t){apply(e,diff(e,t))}require("collections/shim"),exports.graphOt=graphOt,exports.traceOt=traceOt,exports.ot=ot,exports.diff=diff,exports.apply=apply,exports.merge=merge;