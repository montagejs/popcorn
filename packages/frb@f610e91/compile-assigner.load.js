montageDefine("f610e91","compile-assigner",{dependencies:["./compile-evaluator","./algebra","./scope"],factory:function(e,r,t){function n(e){return n.semantics.compile(e)}var a=e("./compile-evaluator"),i=e("./algebra"),l=(e("./scope"),{type:"value"}),o={type:"literal",value:!0},u={type:"literal",value:!1};t.exports=n,n.semantics={compile:function(e){var r=this.compilers;if("equals"===e.type){var t=this.compile(e.args[0]),n=this.compileEvaluator(e.args[1]);return r.equals(t,n)}if("if"===e.type){var a=this.compileEvaluator(e.args[0]),o=this.compile(e.args[1]),u=this.compile(e.args[2]);return r["if"](a,o,u)}if("and"===e.type||"or"===e.type){var c=i(e.args[0],l),s=i(e.args[1],l),p=this.compileEvaluator(e.args[0]),n=this.compileEvaluator(e.args[1]),f=this.compileEvaluator(c[1]),v=this.compileEvaluator(s[1]),t=this.compile(c[0]),m=this.compile(s[0]);return r[e.type](t,m,p,n,f,v)}if("everyBlock"===e.type){var h=this.compileEvaluator(e.args[0]),y=i(e.args[1],{type:"literal",value:!0}),g=this.compile(y[0]),E=this.compileEvaluator(y[1]);return r.everyBlock(h,g,E)}if("parent"===e.type){var d=this.compile(e.args[0]);return function(e,r){return d(e,r.parent)}}if(r.hasOwnProperty(e.type)){var w=e.args.map(this.compileEvaluator,this.compileEvaluator.semantics);return 1===w.length?r[e.type].call(null,w[0]):2===w.length?r[e.type].call(null,w[0],w[1]):r[e.type].apply(null,w)}throw new Error("Can't compile assigner for "+JSON.stringify(e.type))},compileEvaluator:a,compilers:{property:function(e,r){return function(t,n){var a=e(n);if(a){var i=r(n);null!=i&&(Array.isArray(a)?a.set(i,t):a[i]=t)}}},get:function(e,r){return function(t,n){var a=e(n);if(a){var i=r(n);null!=i&&a.set(i,t)}}},has:function(e,r){return function(t,n){var a=e(n);if(a){var i=r(n);null!=t&&(t?(a.has||a.contains).call(a,i)||a.add(i):(a.has||a.contains).call(a,i)&&(a.remove||a["delete"]).call(a,i))}}},equals:function(e,r){return function(t,n){if(t)return e(r(n),n)}},"if":function(e,r,t){return function(n,a){var i=e(a);if(null!=i)return i?r(n,a):t(n,a)}},and:function(e,r,t,n,a,i){return function(l,u){null!=l&&(l?(e(a(o),u),r(i(o),u)):e(t(u)&&!n(u),u))}},or:function(e,r,t,n,a,i){return function(l,o){null!=l&&(l?e(t(o)||!n(o),o):(e(a(u),o),r(i(u),o)))}},rangeContent:function(e){return function(r,t){var n=e(t);n&&(r?n.swap(0,n.length,r):n.clear())}},mapContent:function(e){return function(r,t){var n=e(t);n&&(n.clear(),t.value&&n.addEach(r))}},reversed:function(e){return function(r,t){var n=e(t);n&&n.swap(0,n.length,r.reversed())}},everyBlock:function(e,r,t){return function(n,a){if(n){var i=e(a),l=t(a);i.forEach(function(e){r(l,a.nest(e))})}}}}}}});