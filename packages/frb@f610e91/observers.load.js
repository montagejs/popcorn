montageDefine("f610e91","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/sorted-set","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(n,e,r){function t(n){return function(e){return e(n)}}function u(n,e){return n(e.value)}function o(n,e){return n(e.parameters)}function i(n){return function(e,r){return e(r.document.getElementById(n))}}function a(n,e){return function(e,r){var t=r.components,u=t.getObjectByLabel||t.getComponentByLabel,o=u.call(t,n);return e(o)}}function c(n,e,r,t){function u(n,e,t){o&&o(),o=r(n,e,t)}if(null==n)return r();var o;return Ln.addOwnPropertyChangeListener(n,e,u,t.beforeChange),u(n[e],e,n),function(){o&&o(),Ln.removeOwnPropertyChangeListener(n,e,u,t.beforeChange)}}function f(n,e){return function(r,t){return e(function(e){function u(n){return null==n?u.emit():n.observeProperty?n.observeProperty(e,u.emit,u.scope):u.observeProperty(n,e,u.emit,u.scope)}return"string"!=typeof e&&"number"!=typeof e?r():(u.observeProperty=Pn,u.emit=r,u.scope=t,n(u,t))},t)}}function l(n,e,r,t){function u(n,t,u){i(e,t)&&(o&&o(),o=r(n,e,u))}var o,i=n.contentEquals||Object.equals;return u(n.get(e),e,n),n.addMapChangeListener(u,t.beforeChange),function(){o&&o(),n.removeMapChangeListener(u)}}function s(n,e){return function(r,t){return n(function(n){function u(e){return null==e?r():n.observeGet?n.observeGet(e,r,t):u.observeGet(n,e,r,t)}return n?(u.observeGet=Gn,e(u,t)):r()},t)}}function v(n,e){return function(r,t){return r=Cn(r),e(function(e){return n(function(n){return n?n.addRangeChangeListener?Z(n,function(){return r((n.has||n.contains).call(n,e))},t):n.addMapChangeListener?cn(n,function(){return r(n.has(e))},t):r():r()},t)},t)}}function g(n){return function(e,r){for(var t=[],u=[],o=0,i=n.length;o<i;o++)t[o]=void 0,u[o]=function(n,e){return n(function(n){t.set(e,n)},r)}(n[o],o);var a=e(t);return function(){a&&a();for(var n=0,e=u.length;n<e;n++)a=u[n],a&&a()}}}function h(n){return function(e,r){var t,u={},o={},i=Object.keys(n);for(t=0;name=i[t];t++)!function(n,e){o[n]=void 0,u[n]=e(function(e){o[n]=e},r)}(name,n[name]);var a=e(o);return function(){a&&a();var n,e=Object.keys(u);for(n=0;name=e[n];n++)a=u[name],a&&a()}}}function p(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];return g(n)}function m(n){return function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];var t=g(e),u=on(t);return function(e,r){return u(function(r){return r.every(jn.defined)?e(1===r.length?n.call(void 0,r[0]):2===r.length?n.call(void 0,r[0],r[1]):n.apply(void 0,r)):e()},r)}}}function b(n){var e=n.slice(0,1).toUpperCase();e+=n.slice(1);var r="make";r+=e,r+="Observer";var t="observe";return t+=e,function(){var e=arguments[0],u=Array.prototype.slice.call(arguments,1),o=g(u),i=on(o);return function(o,a){return e(function(e){return e?e[r]?1===u.length?e[r].call(e,u[0])(o,a):2===u.length?e[r].call(e,u[0],u[1])(o,a):e[r].apply(e,u)(o,a):e[t]?e[t](o,a):i(function(r){return r.every(jn.defined)&&"function"==typeof e[n]?o(1===r.length?e[n].call(e,r[0]):2===r.length?e[n].call(e,r[0],r[1]):e[n].apply(e,r)):o()},a):o()},a)}}}function d(n){return function(e,r){return n(function(n){return e(!n)},r)}}function O(n,e){return function(r,t){return n(function(n){return n?e(r,t):r(n)},t)}}function k(n,e){return function(r,t){return n(function(n){return n?r(n):e(r,t)},t)}}function y(n,e,r){return function(t,u){return n(function(n){return null==n?t():n?e(t,u):r(t,u)},u)}}function C(n){return function(e,r){return n(function(n){return e(null!=n)},r)}}function w(n,e){return function(r,t){return n(function(n){return null==n?e(r,t):r(n)},t)}}function E(n,e){return function(r,t){return n(function(n){function u(e){for(var r=0,t=n.length;r<t;r++)a[r].index=r}function o(n,r,o){function f(n,e,r,t,u,o,i,a){function c(n){g?u.set(f.index,n):o[e]=n}var f=t[r+e];return i(c,a.nest(n))}var l,s,v=[];for(l=0,s=n.length;l<s;l++)v[l]={index:o+l};Mn(a,o,r.length,v),u(o+n.length);var g,h,p=[],m=o,b=o+r.length;for(m=o,b=o+r.length;m<b;m++)h=c[m],h&&h();for(l=0,s=n.length;l<s;l++)v[l]=f(n[l],l,o,a,i,p,e,t);Mn(c,o,r.length,v),g=!0,i.swap(o,r.length,p)}if(!n)return r();var i=[],a=[],c=[],f=Z(n,o,t),l=r(i,n);return function(){l&&l();for(var n=0,e=c.length;n<e;n++)l=c[n],l&&l();f()}},t)}}function M(n,e){var r=E(n,e);return function(n,e){return r(function(r,t){function u(n){for(;n<r.length;n++)c[n+1]=c[n]+!!r[n]}function o(n,e,r){var o=t.slice(r,r+n.length),a=e.map(Boolean).sum(),f=o.filter(function(e,r){return n[r]}),l=c[r],s=i.slice(l,l+a);(s.length!==f.length||s.some(function(n,e){return n!==f[e]}))&&i.swap(l,a,f),u(l)}if(!t)return n();var i=[],a=[],c=[0],f=Z(r,o,e),l=n(i);return function(){l&&l();for(var n=0,e=a.length;n<e;n++)l=a[n],l&&l();f()}},e)}}function L(n,e){var r=B(e),t=E(n,r),u=function(n,e){return t(function(r){function t(n,e){o.deleteEach(e),o.addEach(n)}if(!r)return n();var u=[],o=xn(u,x,R),i=Z(r,t,e),a=n(u);return function(){a&&a(),i()}},e)};return Nn(u,vn)}function x(n,e){return Object.equals(n[1],e[1])}function R(n,e){return Object.compare(n[1],e[1])}function B(n){return function(e,r){return n(function(n){return e([r.value,n])},r)}}function A(n,e){var r=B(e),t=E(n,r),u=q(t,hn),o=E(u,_(hn));return function(n,e){function r(n,e){return n=a.get(n),e=a.get(e),Object.compare(n,e)}function t(n,e){return n=a.get(n),e=a.get(e),Object.equals(n,e)}function u(n,e){var r,t,u;for(r=0,t=e.length;r<t;r++)u=e[r],c["delete"](u[0]),a["delete"](u[0]);for(r=0,t=n.length;r<t;r++)u=n[r],a.set(u[0],u[1]),c.add(u[0])}function i(n){return c.clear(),Z(n,u,e)}var a=new Bn,c=new Rn(null,t,r),f=n(c),l=o(i,e);return function(){f&&f(),l()}}}function j(n){return function(e,r){return n(function(n){function t(n,e,r){var t=u.length-r-e.length;u.swap(t,e.length,n.reversed())}if(!n)return e();var u=[],o=Z(n,t,r),i=e(u);return function(){i&&i(),o()}},r)}}function P(n){return function(e,r){return n(function(n){function t(e){for(var r=e;r<n.length;r++)c[r].index=r,n[r]?a[r+1]=a[r]+n[r].length:a[r+1]=a[r]}function u(n,e,u){var f=a[u],l=a[u+e.length],s=l-f;o.swap(f,s,[]),Mn(c,u,e.length,n.map(function(){return{index:null}})),t(u);for(var v,g=u,l=u+e.length;g<l;g++)v=i[g],v&&v();Mn(i,u,e.length,n.map(function(n,e){function i(n,e,r){t(f.index);var u=a[f.index]+r,i=a[f.index]+r+e.length,c=i-u;o.swap(u,c,n)}var f=c[u+e];return Z(n,i,r)}))}if(!n)return e();var o=[],i=[],a=[0],c=[],f=Z(n,u,r),l=e(o);return function(){l&&l();for(var n=0,e=i.length;n<e;n++)l=i[n],l&&l();f()}},r)}}function G(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];return qn(g(n))}function N(n,e){var r=Sn(n,e),t=f(r,Fn);return bn(t,Boolean)}function S(n,e){var r=bn(e,jn.not),t=Sn(n,r),u=f(t,Fn);return bn(u,jn.not)}function q(n,e){var r=F(n,e);return Kn(r)}function F(n,e){var r=B(e),t=E(n,r);return function(n,e){return t(function(r,t){function u(n,e,r){var u,i,a,c,f;for(u=0,i=e.length;u<i;u++)a=e[u],c=o.get(a[1]),1===c.length?o["delete"](a[1]):c["delete"](a[0]);for(u=0,i=n.length;u<i;u++)a=n[u],f=!o.has(a[1]),c=f?t.constructClone():o.get(a[1]),c.add(a[0]),f&&o.set(a[1],c)}if(!r)return n();var o=new Bn,i=Z(r,u,e),a=n(o);return function(){i(),a&&a()}},e)}}function T(n,e,r){function t(n,e){return Object.compare(n[1],e[1])*r}var u=B(e),o=E(n,u);return function(n,e){return o(function(r){function u(n,e){i.addEach(n),i.deleteEach(e)}function o(e,r){if(0===r)return e?n(e[0]):n()}if(!r)return n();var i=new An(null,x,t),a=Z(r,u,e),c=cn(i,o,e);return function(){a(),c()}},e)}}function V(n,e){return T(n,e,1)}function D(n,e){return T(n,e,-1)}function K(n){return T(n,u,1)}function W(n){return T(n,u,-1)}function U(n){return function(e){return function(r,t){return r=Cn(r),e(function(e){if(!e)return r();var u=n(e,r);return Z(e,function(n,e,t){return r(u(n,e,t))},t)},t)}}}function H(n){return"number"==typeof n&&!isNaN(n)}function I(n,e,r){return r||(r=e,e=Tn),function(t,u){return n(function(n){function o(e,r,t){if(s){var u=e.length-r.length;t<=a?u>0?(l.swap(0,0,n.slice(a,a+u)),l.splice(i,l.length-i)):(l.splice(0,-u),l.swap(l.length,0,n.slice(a+l.length,a+i))):t<a+i&&(l.swap(t-a,r.length,e),u>0?l.splice(i,l.length-i):l.swap(l.length,0,n.slice(a+l.length,a+i)))}}if(!n)return t();var i,a,c,f,l=[],s=!1,v=Z(n,o,u),g=r(function(e){e=+e,isNaN(e)&&(e=void 0);var r="number"==typeof e&&"number"==typeof a,t=Math.max(0,e);"number"==typeof f&&(t=Math.min(t,n.length-f)),s!==r?(r?l.swap(0,0,n.slice(f,f+t)):l.clear(),s=r):s&&c!==t&&(t<c?l.splice(e,c-t):l.swap(c,0,n.slice(f+c,f+t))),i=e,c=t},u),h=e(function(e){e=+e,isNaN(e)&&(e=void 0);var r="number"==typeof i&&"number"==typeof e,t=Math.max(0,e);"number"==typeof i&&(t=Math.min(t,n.length));var u=Math.max(0,i);if("number"==typeof t&&(u=Math.min(u,n.length-t)),s!==r)r?l.swap(0,l.length,n.slice(t,t+u)):l.clear(),s=r;else if(s&&f!==t){var o=Math.abs(t-f);o<c&&t<f?(l.swap(0,0,n.slice(t,f)),l.splice(u,l.length-u)):o<c&&t>f?(l.swap(l.length,0,n.slice(f+c,t+u)),l.splice(0,l.length-u)):l.swap(0,l.length,n.slice(t,t+u))}a=e,f=t,c=u},u),p=t(l);return function(){p&&p(),g(),h(),v()}},u)}}function J(n){return function(e,r){return n(function(n){function t(n){for(;n<o.length;n++)o[n].set(0,n)}function u(n,e,r){o.swap(r,e.length,n.map(function(n,e){return[r+e,n]})),t(r+n.length)}if(!n)return e();var o=[],i=Z(n,u,r),a=e(o);return function(){a&&a(),i()}},r)}}function $(n){return function(e,r){var t=[],u=e(t),o=n(function(n){if(n>>>=0,null==n)t.clear();else if(n>t.length){for(var e=[],r=t.length;r<n;r++)e.push(r);t.swap(t.length,0,e)}else n<t.length&&t.splice(n,t.length)},r);return function(){u&&u(),o&&o()}}}function z(n,e){return function(r,t){return e(function(e){if("string"!=typeof e)return r();var u=new RegExp("^"+RegExp.escape(e));return n(function(n){return"string"!=typeof n?r():r(u.test(n))},t)},t)}}function Q(n,e){return function(r,t){return e(function(e){if("string"!=typeof e)return r();var u=new RegExp(RegExp.escape(e)+"$");return n(function(n){return"string"!=typeof n?r():r(u.test(n))},t)},t)}}function X(n,e){return function(r,t){return e(function(e){if("string"!=typeof e)return r();var u=new RegExp(RegExp.escape(e));return n(function(n){return"string"!=typeof n?r():r(u.test(n))},t)},t)}}function Y(n,e){return e=e||Vn,function(r,t){return n(function(n){return n?e(function(e){function u(){o&&o(),o=r(n.join(e))}if("string"!=typeof e)return r();var o,i=Z(n,u,t);return function(){i(),o&&o()}},t):r()},t)}}function Z(n,e,r){function t(n,r,t){u&&u(),u=e(n,r,t)}if(!n||!n.toArray||!n.addRangeChangeListener)return Function.noop;var u,o;return t(Array.isArray(n)?n:n.toArray(),Array.empty,0),o=n.addRangeChangeListener(t,null,r.beforeChange),function(){u&&u(),o()}}function _(n){return function(e,r){return n(function(n){return Dn(n,e,r)},r)}}function nn(n,e,r){function t(r,t,a){if(o+=r.length-t.length,!(a+t.length<o&&a+r.length<o)){var c=o<0?null:n.get(o);u&&u(),u=e(c),i=c}}var u,o=-1,i=null,a=Z(n,t,r);return function(){u&&u(),a&&a()}}function en(n){return function(e,r){return n(Cn(function(n){return rn(n,e,r)}),r)}}function rn(n,e,r){function t(r,t,o){return u+=r.length-t.length,1!==u?e():e(n.only())}var u=0;return Z(n,t,r)}function tn(n){return function(e,r){return n(Cn(function(n){return un(n,e,r)}),r)}}function un(n,e,r){function t(r,t,o){return u+=r.length-t.length,0===u?e():e(n.one())}var u=0;return Z(n,t,r)}function on(n){return function(e,r){return n(function(n){return n&&n.addRangeChangeListener?Z(n,function(){return e(n)},r):e(n)},r)}}function an(n){return function(e,r){return n(function(n){return n&&n.addMapChangeListener?cn(n,function(){return e(n)},r):e(n)},r)}}function cn(n,e,r){function t(n,r,t){var o=u.get(r);u["delete"](r),o&&o(),o=e(n,r,t),void 0===n?o&&o():u.set(r,o)}if(n.addMapChangeListener){var u=new Bn;n.forEach(t);var o=n.addMapChangeListener(t,r.beforeChange);return function(){u.forEach(function(n){n&&n()}),o()}}}function fn(n){return function(e,r){return n(function(n){return n?ln(n,e,r):e()},r)}}function ln(n,e,r){function t(n,e,r){var t,i;o.has(e)?null==n?(t=o.get(e),o["delete"](e),i=u.indexOf(t),u.splice(i,1)):(t=o.get(e),t.set(1,n)):(t=[e,n],o.set(e,t),u.push(t))}var u=[],o=new Bn,i=e(u),a=cn(n,t,r);return function(){i&&i(),a&&a()}}function sn(n){var e=Kn(n);return Nn(e,vn)}function vn(n,e){return e.value?n(e.value[0]):n()}function gn(n){var e=Kn(n);return Nn(e,hn)}function hn(n,e){return e.value?n(e.value[1]):n()}function pn(n){return function(e,r){var t=new Bn,u=e(t),o=n(function(n){if(t.clear(),n&&"object"==typeof n){if(n.addRangeChangeListener)return Wn(function(n){function e(n,e){var r,u;for(r=0,u=e.length;r<u;r++)t["delete"](e[r][0]);for(r=0,u=n.length;r<u;r++)t.set(n[r][0],n[r][1])}return Z(n,e,r)},r.nest(n));if(n.addMapChangeListener)return cn(n,function(n,e){void 0===n?t["delete"](e):t.set(e,n)},r);var e=[],u=0;for(var o in n)e[u++]=Pn(n,o,function(n){void 0===n?t["delete"](o):t.set(o,n)},r);return function(){for(var n=0,r=e.length;n<r;n++)e[n]()}}},r)||Function.noop;return function(){u&&u(),o()}}}function mn(n){return function(e,r){return r.parent?n(e,r.parent):e()}}function bn(n,e,r){return function(t,u){return t=Cn(t),n(function(n){return t(e.call(r,n))},u)}}function dn(n,e,r){return function(t,u){return t=Cn(t),n(function(n){if(n&&n.every(jn.defined))return t(1===n.length?e.call(r,n[0]):2===n.length?e.call(r,n[0],n[1]):e.apply(r,n))},u)}}function On(e,r){var t=n("./parse"),u=n("./compile-observer");return function(n,o){return n=Cn(n),r(function(r){if(null==r)return n();var i,a;try{i=t(r),a=u(i)}catch(c){return n()}return e(function(e){return a(n,o.nest(e))},o)},o)}}function kn(n,e){return function(r,t){return n(function(n){return null==n?r():e(function(n){return null==n?r():r(n)},t.nest(n))},t)}}function yn(n){return function(){var e;return e=1===arguments.length?n.call(this,arguments[0]):2===arguments.length?n.call(this,arguments[0],arguments[1]):n.apply(this,arguments),function(n,r){var t=[],u=e(function(n){function e(n,e,r){t.swap(r,e.length,n)}return n&&n.addRangeChangeListener?(Un(t,n),n.addRangeChangeListener(e,null,r.beforeChange),function(){n.removeRangeChangeListener(e,null,r.beforeChange)}):void t.clear()},r),o=n(t);return function(){u&&u(),o&&o()}}}}function Cn(n){var e;return function(r){if(r!==e){var t;return t=1===arguments.length?n.call(this,arguments[0]):2===arguments.length?n.apply(this,arguments[0],arguments[1]):n.apply(this,arguments),e=r,t}}}function wn(n){n.forEach(function(n){n&&n()})}function En(n){var e;return function(){if(e&&e(),1===arguments.length)e=n.call(void 0,arguments[0]);else if(2===arguments.length)e=n.call(void 0,arguments[0],arguments[1]);else if(3===arguments.length)e=n.call(void 0,arguments[0],arguments[1],arguments[2]);else{for(var r=new Array(arguments.length),t=0,u=arguments.length;t<u;t++)r[t]=arguments[t];e=n.apply(void 0,r)}return function(){e&&e(),e=void 0}}}function Mn(n,e,r,t){e<0?e=n.length+e:e>n.length&&(n.length=e),e+r>n.length?r=n.length-e:r<0&&(r=0);var u=t.length-r,o=n.length,i=n.length+u;if(u>0)for(var a=o-1;a>=e+r;a--){var c=a+u;a in n?n[c]=n[a]:(n[c]=void 0,delete n[c])}for(var a=0;a<t.length;a++)a in t?n[e+a]=t[a]:(n[e+a]=void 0,delete n[e+a]);if(u<0)for(var a=e+t.length;a<o-u;a++){var c=a-u;c in n?n[a]=n[c]:(n[a]=void 0,delete n[a])}n.length=i}n("collections/shim");var Ln=n("collections/listen/property-changes");n("collections/listen/array-changes");var xn=n("collections/sorted-array"),Rn=n("collections/sorted-set"),Bn=n("collections/map"),An=(n("collections/set"),n("collections/heap")),jn=(n("./scope"),n("./operators"));e.makeLiteralObserver=t,e.observeValue=u,e.observeParameters=o,e.makeElementObserver=i,e.makeComponentObserver=a,e.observeProperty=c;var Pn=c;e.makePropertyObserver=f,e.observeKey=l,e.observeGet=l;var Gn=l;e.makeGetObserver=s,e.makeHasObserver=v,e.makeObserversObserver=g,e.makeRecordObserver=h,e.makeObjectObserver=h,e.makeTupleObserver=p,e.makeArrayObserver=p,e.makeOperatorObserverMaker=m,e.makeMethodObserverMaker=b,e.makeNotObserver=d,e.makeAndObserver=O,e.makeOrObserver=k,e.makeConditionalObserver=y,e.makeDefinedObserver=C,e.makeDefaultObserver=w;var Nn=e.makeMapBlockObserver=yn(E),Sn=e.makeFilterBlockObserver=yn(M);e.makeSortedBlockObserver=L,e.makeSortedSetBlockObserver=A,e.makeReversedObserver=yn(j);var qn=e.makeFlattenObserver=yn(P);e.makeConcatObserver=G,e.makeSomeBlockObserver=N,e.makeEveryBlockObserver=S,e.makeGroupBlockObserver=q,e.makeGroupMapBlockObserver=F,e.makeMaxBlockObserver=V,e.makeMinBlockObserver=D,e.makeMaxObserver=K,e.makeMinObserver=W;var Fn=t("length");e.makeSumObserver=U(function(){var n=0;return function(e,r,t){return e=e.filter(H),r=r.filter(H),n+=e.sum()-r.sum()}}),e.makeAverageObserver=U(function(){var n=0,e=0;return function(r,t,u){return r=r.filter(H),t=t.filter(H),n+=r.sum()-t.sum(),e+=r.length-t.length,n/e}}),e.makeViewObserver=yn(I);var Tn=t(0);e.makeEnumerateObserver=yn(J),e.makeEnumerationObserver=e.makeEnumerateObserver,e.makeRangeObserver=$,e.makeStartsWithObserver=z,e.makeEndsWithObserver=Q,e.makeContainsObserver=X,e.makeJoinObserver=Y;var Vn=t("");e.observeRangeChange=Z,e.makeLastObserver=_,e.observeLast=nn;var Dn=nn;e.makeOnlyObserver=en,e.observeOnly=rn,e.makeOneObserver=tn,e.observeOne=un,e.makeRangeContentObserver=on,e.makeMapContentObserver=an,e.observeMapChange=cn;var Kn=e.makeEntriesObserver=yn(fn);e.observeEntries=ln,e.makeKeysObserver=sn,e.observeEntryKey=vn,e.makeValuesObserver=gn,e.observeEntryValue=hn,e.makeToMapObserver=pn;var Wn=Nn(q(u,vn),_(hn));e.makeParentObserver=mn,e.makeConverterObserver=bn,e.makeComputerObserver=dn,e.makePathObserver=On,e.makeExpressionObserver=On,e.makeWithObserver=kn,e.makeToArrayObserver=yn(Function.identity),e.makeAsArrayObserver=e.makeToArrayObserver;var Un=n("./merge").merge;e.makeUniq=Cn,e.cancelEach=wn,e.autoCancelPrevious=En}});