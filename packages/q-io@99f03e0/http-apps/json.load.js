montageDefine("99f03e0","http-apps/json",{dependencies:["q","./content","./status"],factory:function(n,t,e){var o=n("q"),r=n("./content"),s=n("./status");t.HandleJsonResponses=function(n,e,r){return function(s){return s.handleJsonResponse=t.handleJsonResponse,o.fcall(n,s).then(function(n){return void 0!==n.data?o.fcall(t.handleJsonResponse,n,e,r):n})}},t.handleJsonResponse=function(n,t,e){return n.headers["content-type"]="application/json",n.body={forEach:function(o){o(JSON.stringify(n.data,t,e))}},n},t.Json=function(n,e,r){return function(s,a){return o.when(n(s,a),function(n){return t.json(n,e,r)})}},t.json=function(n,t,e){try{var s=JSON.stringify(n,t,e)}catch(a){return o.reject(a)}return r.ok([s],"application/json")},t.JsonRequest=function(n,t){return t||(t=s.badRequest),r.ContentRequest(function(e,o,r){try{var s=JSON.parse(e)}catch(a){return t(o,a)}return n(s,o,r)})}}});