"use strict";var isFunction=require("../function/is-function");module.exports=function(e){var t;if(isFunction(this))t=this;else{if("function"!=typeof Promise)throw new TypeError("Could not resolve Promise constuctor");t=Promise}var n,r=new t(function(t,r){n=function(n,i){if(!hasOwnProperty.call(this,"then"))throw new Error("Unexpected (inherited) lazy then invocation");try{e(t,r)}catch(o){r(o)}return delete this.then,this.then(n,i)}});return Object.defineProperty(r,"then",{configurable:!0,writable:!0,value:n})};