"use strict";var iteratorSymbol=require("es6-symbol").iterator,isArguments=require("../../function/is-arguments"),isFunction=require("../../function/is-function"),toPosInt=require("../../number/to-pos-integer"),callable=require("../../object/valid-callable"),validValue=require("../../object/valid-value"),isValue=require("../../object/is-value"),isString=require("../../string/is-string"),isArray=Array.isArray,call=Function.prototype.call,desc={configurable:!0,enumerable:!0,writable:!0,value:null},defineProperty=Object.defineProperty;module.exports=function(e){var r,l,i,t,a,n,s,u,o,c,d=arguments[1],f=arguments[2];if(e=Object(validValue(e)),isValue(d)&&callable(d),this&&this!==Array&&isFunction(this))r=this;else{if(!d){if(isArguments(e))return a=e.length,1!==a?Array.apply(null,e):(t=new Array(1),t[0]=e[0],t);if(isArray(e)){for(t=new Array(a=e.length),l=0;l<a;++l)t[l]=e[l];return t}}t=[]}if(!isArray(e))if(void 0!==(o=e[iteratorSymbol])){for(s=callable(o).call(e),r&&(t=new r),u=s.next(),l=0;!u.done;)c=d?call.call(d,f,u.value,l):u.value,r?(desc.value=c,defineProperty(t,l,desc)):t[l]=c,u=s.next(),++l;a=l}else if(isString(e)){for(a=e.length,r&&(t=new r),l=0,i=0;l<a;++l)c=e[l],l+1<a&&(n=c.charCodeAt(0),n>=55296&&n<=56319&&(c+=e[++l])),c=d?call.call(d,f,c,i):c,r?(desc.value=c,defineProperty(t,i,desc)):t[i]=c,++i;a=i}if(void 0===a)for(a=toPosInt(e.length),r&&(t=new r(a)),l=0;l<a;++l)c=d?call.call(d,f,e[l],l):e[l],r?(desc.value=c,defineProperty(t,l,desc)):t[l]=c;return r&&(desc.value=null,t.length=a),t};