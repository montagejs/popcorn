var Component=require("../component").Component,PressComposer=require("../../composer/press-composer").PressComposer,assign=require("frb/assign"),Montage=require("../../core/core").Montage;exports.ListItem=Component.specialize({_templateDidLoad:{value:!1},templateDidLoad:{value:function(){this.defineBindings({_iconSrc:{"<-":"data.defined() && userInterfaceDescriptor.defined() ? (data.path(userInterfaceDescriptor.iconExpression || null) || path(userInterfaceDescriptor.iconExpression || null)) : iconSrc"},_defaultIconComponenModule:{"<-":"iconComponentModule || _montageIconComponentModule"},_iconComponentModule:{"<-":"data.defined() && userInterfaceDescriptor.defined() ? (userInterfaceDescriptor.iconComponentModule || _defaultIconComponenModule) : _defaultIconComponenModule"},_label:{"<-":"data.defined() && userInterfaceDescriptor.defined() ? (data.path(userInterfaceDescriptor.nameExpression) || label) : (label || data)"},_description:{"<-":"data.defined() && userInterfaceDescriptor.defined() ? (data.path(userInterfaceDescriptor.descriptionExpression) || description) : description"},__value:{"<-":"data.defined() && userInterfaceDescriptor.defined() ? data.path(userInterfaceDescriptor.valueExpression) : _value"},_defaultToggleComponentModule:{"<-":"toggleComponentModule || _montageToogleComponentModule"},_toggleComponentModule:{"<-":"__value.defined() && userInterfaceDescriptor.defined() ? (userInterfaceDescriptor.listItemToggleComponentModule || _defaultToggleComponentModule) : _defaultToggleComponentModule"},_descriptionPosition:{"<-":"userInterfaceDescriptor.defined() ? (userInterfaceDescriptor.listItemDescriptionPosition || descriptionPosition) : descriptionPosition"},_isExpandable:{"<-":"userInterfaceDescriptor.defined() ? (userInterfaceDescriptor.listItemIsExpandable || isExpandable) : isExpandable"}}),this._templateDidLoad=!0,this._loadDataUserInterfaceDescriptorIfNeeded()}},_value:{value:null},value:{set:function(e){this._value=!!e},get:function(){return this._value}},_isExpandable:{value:!1},isExpandable:{set:function(e){this._isExpandable=!!e},get:function(){return this._isExpandable}},_descriptionPosition:{value:null},descriptionPosition:{set:function(e){this._descriptionPosition="bottom"===e?e:"right"},get:function(){return this._descriptionPosition}},active:{value:!1},selected:{value:!1},label:{value:null},description:{value:null},iconComponentModule:{value:null},toggleComponentModule:{value:null},iconSrc:{value:null},_data:{value:null},data:{get:function(){return this._data},set:function(e){this._data!==e&&(this._data=e,this._loadDataUserInterfaceDescriptorIfNeeded())}},rowIndex:{value:-1},list:{value:null},userInterfaceDescriptor:{value:null},__pressComposer:{value:null},_pressComposer:{get:function(){return this.__pressComposer||(this.__pressComposer=new PressComposer,this.__pressComposer.delegate=this,this.addComposerForElement(this.__pressComposer,this._valuePlaceholderComponent.element)),this.__pressComposer}},shouldComposerSurrenderPointerToComponent:{value:function(e,t,o){return e!==this.__pressComposer||!this.element.contains(o.element)}},enterDocument:{value:function(){this._startListeningToPressIfNeeded()}},prepareForActivationEvents:{value:function(){this._startListeningToPress()}},exitDocument:{value:function(){this._startListeningToPressIfNeeded()}},_startListeningToPressIfNeeded:{value:function(){this.preparedForActivationEvents&&this._startListeningToPress()}},_startListeningToPress:{value:function(){this._pressComposer.addEventListener("press",this)}},_stopListeningToPress:{value:function(){this.preparedForActivationEvents&&this._pressComposer.removeEventListener("press",this)}},handlePress:{value:function(){var e=!this.__value;this.data&&this.userInterfaceDescriptor&&this.userInterfaceDescriptor.valueExpression&&assign(this.data,this.userInterfaceDescriptor.valueExpression,e),this.value=e}},_loadDataUserInterfaceDescriptorIfNeeded:{value:function(){if(this.data&&this._templateDidLoad){var e,t=this;return this.loadUserInterfaceDescriptor(this.data).then(function(o){t.userInterfaceDescriptor=o||t.userInterfaceDescriptor;var n,i,s=t._iconComponentModule?t._iconComponentModule.id:null,r=t._toggleComponentModule?t._toggleComponentModule.id:null;t._label=t.callDelegateMethod("listItemWillUseLabelForObjectAtRowIndex",t,t._label,t.data,t.rowIndex,t.list)||t._label,t._description=t.callDelegateMethod("listItemWillUseDescriptionForObjectAtRowIndex",t,t._description,t.data,t.rowIndex,t.list)||t._description,i=t.callDelegateMethod("listItemWillUseIconComponentModuleIdForObjectAtRowIndex",t,s,t.data,t.rowIndex,t.list)||s,i&&s!==i&&t.delegate&&(e=Montage.getInfoForObject(t.delegate),t._iconComponentModule={require:e.require||require,id:i}),t._iconComponentModule===t._montageIconComponentModule&&(t._iconSrc=t.callDelegateMethod("listItemWillUseIconSrcForObjectAtRowIndex",t,t._iconSrc,t.data,t.rowIndex,t.list)||t._iconSrc),n=t.callDelegateMethod("listItemWillUseToggleComponentModuleIdForObjectAtRowIndex",t,r,t.data,t.rowIndex,t.list)||r,n&&r!==n&&t.delegate&&(e=e||Montage.getInfoForObject(t.delegate),t._defaultToggleComponentModule={require:e.require||require,id:n}),t._descriptionPosition=t.callDelegateMethod("listItemWillUseDescriptionPositionForObjectAtRowIndex",t,t.descriptionPosition,t.data,t.rowIndex,t.list)||t._descriptionPosition,t._isExpandable=t.callDelegateMethod("listItemShouldBeExpandableForObjectAtRowIndex",t,t._isExpandable,t.data,t.rowIndex,t.list)||t._isExpandable})}}}});