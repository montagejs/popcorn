montageDefine("64d2e12","ui/authorization-manager-panel.reel/authorization-manager-panel",{dependencies:["ui/component","core/promise","core/application","collections/map","montage"],factory:function(e,i,t){var a=e("ui/component").Component,o=e("core/promise").Promise,n=e("core/application").application,r=e("collections/map"),l=e("montage").Montage;i.AuthorizationManagerPanel=a.specialize({panels:{get:function(){return this._panels||(this._panels=[]),this._panels},set:function(e){console.warn("AuthorizationManagerPanel.panels.set",e)}},authorizationManager:{value:void 0},approveAuthorization:{value:function(e,i){i&&this._deregisterPanel(i,e),!this.panels.length&&this._authorizationResolve&&this._authorizationResolve(e)}},_deregisterPanel:{value:function(e,i){var t=this.panels.indexOf(e),a=l.getInfoForObject(e);t!==-1&&this.panels.splice(t,1),i?this._authorizationPromiseByPanel.get(e).resolve(i):this._authorizationPromiseByPanel.get(e).reject(new Error("Authorization Rejected for panel ("+a.id+")")),this._authorizationPromiseByPanel["delete"](e)}},_authorizationPromiseByPanel:{get:function(){return this.__authorizationPromiseByPanel||(this.__authorizationPromiseByPanel=new r),this.__authorizationPromiseByPanel}},authorizeWithPanel:{value:function(e){var i,t=this;return this._authorizationPromiseByPanel.has(e)?i=o.resolve(null):(i=new o(function(i,a){t._authorizationPromiseByPanel.set(e,{resolve:i,reject:a})}),this.panels.push(e)),i}},_authorizationResolve:{value:void 0},cancelAuthorization:{value:function(e){e&&this._deregisterPanel(e),n.applicationModal&&n.applicationModal.hide(this),this._authorizationResolve&&this._authorizationReject("CANCEL")}},_authorizationReject:{value:void 0},runModal:{value:function(){var e=this;return new o(function(i,t){e._authorizationResolve=i,e._authorizationReject=t,n.applicationModal&&n.applicationModal.show(e)})}}})}});