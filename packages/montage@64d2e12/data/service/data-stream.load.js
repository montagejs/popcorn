montageDefine("64d2e12","data/service/data-stream",{dependencies:["data/service/data-provider","core/meta/object-descriptor","data/model/data-query","core/promise","core/deprecate","frb/parse","frb/scope","frb/compile-evaluator"],factory:function(e,t,a){var r=e("data/service/data-provider").DataProvider,i=e("core/meta/object-descriptor").ObjectDescriptor,s=e("data/model/data-query").DataQuery,o=e("core/promise").Promise,n=e("core/deprecate"),c=e("frb/parse"),u=e("frb/scope"),d=e("frb/compile-evaluator");t.DataStream=r.specialize({query:{value:void 0},selector:{get:n.deprecateMethod(void 0,function(){return this.query},"selector","query"),set:n.deprecateMethod(void 0,function(e){this.query=e},"selector","query")},data:{get:function(){return this._data||(this._data=[]),this._data}},requestData:{value:function(e,t){return this}},_resolve:{value:function(e){this.__promise||(this.__promise=o.resolve(e))}},_reject:{value:function(e){this.__promise||(this.__promise=function(){return o.reject(e)})}},_promise:{get:function(){var e=this;return"function"==typeof this.__promise?this.__promise=this.__promise():this.__promise||(this.__promise=new o(function(t,a){e._resolve=t,e._reject=a})),this.__promise}},then:{value:function(e,t){return this._promise.then(e,t)}},"catch":{value:function(e){return this._promise["catch"](e)}},addData:{value:function(e){var t=e;this.dataExpression&&e&&(t=this._compiledDataExpression(new u(e))),t&&Array.isArray(t)?this.data.push.apply(this.data,t):t&&this.data.push(t)}},dataDone:{value:function(){this._resolve(this.data),delete this._resolve,delete this._reject}},dataError:{value:function(e){this._reject(e),delete this._reject,delete this._resolve}},_compiledDataExpression:{get:function(){return this.__compiledDataExpression||(this.__compiledDataExpression=d(this._dataExpressionSyntax))}},_dataExpressionSyntax:{get:function(){return this.__dataExpressionSyntax||(this.__dataExpressionSyntax=c(this.dataExpression))}},dataExpression:{value:void 0},evaluateDataExpression:{value:function(e){return this._compiledDataExpression(e)}},dataReceptionTime:{value:void 0},_dataMaxAge:{value:void 0},dataMaxAge:{get:function(){return this._dataMaxAge||this.query.type.maxAge},set:function(e){this._dataMaxAge=e}}},{withTypeOrSelector:{value:n.deprecateMethod(t.DataStream,function(e){return this.withTypeOrQuery(e)},"withTypeOrSelector","withTypeOrQuery",!0)},withTypeOrQuery:{value:function(e){var t=e instanceof i&&e,a=t&&s.withTypeAndCriteria(t)||e,r=new this;return r.query=a,r}}})}});