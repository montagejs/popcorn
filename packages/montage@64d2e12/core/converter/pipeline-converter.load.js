montageDefine("64d2e12","core/converter/pipeline-converter",{dependencies:["./converter","core/promise","collections/set"],factory:function(e,t,r){var n=e("./converter").Converter,o=e("core/promise").Promise,i=e("collections/set");t.PipelineConverter=n.specialize({constructor:{value:function(){this["super"](),this.addRangeAtPathChangeListener("converters",this,"_handleConvertersRangeChange")}},_handleConvertersRangeChange:{value:function(e,t,r){var n,o,v=new i(e),s=new i(t);for(o=0;n=t[o];++o)v.has(n)||(n.owner=null);for(o=0;n=e[o];++o)s.has(n)||(n.owner=n.owner||this)}},deserializeSelf:{value:function(e){var t;t=e.getProperty("converters"),void 0!==t&&(this.converters=t)}},serializeSelf:{value:function(e){this.converters.length>0&&e.setProperty("converters",this.converters)}},converters:{value:void 0},convert:{value:function(e){return this._convertWithConverterAtIndex(e,0)}},_convertWithConverterAtIndex:{value:function(e,t){var r,n=this,i=this.converters[t],v=i.convert(e),s=t===this.converters.length-1,c=this._isThenable(v);return t++,r=s?c?v:o.resolve(v):c?v.then(function(e){return n._convertWithConverterAtIndex(e,t)}):this._convertWithConverterAtIndex(v,t)}},_isThenable:{value:function(e){return!(!e||!e.then||"function"!=typeof e.then)}},revert:{value:function(e){return this._revertWithConverterAtIndex(e,this.converters.length-1)}},_revertWithConverterAtIndex:{value:function(e,t){var r,n=this,i=this.converters[t],v=i.revert(e),s=0===t,c=this._isThenable(v);return t--,r=s?c?v:o.resolve(v):c?v.then(function(e){return n._revertWithConverterAtIndex(e,t)}):this._revertWithConverterAtIndex(v,t)}}})}});