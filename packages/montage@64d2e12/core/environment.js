var Montage=require("./core").Montage,TRIDENT="trident",MSIE="msie",UNKNOWN="unknown",CRIOS="crios",FXIOS="fxios",CROS="cros",OPR="opr",Environment=exports.Environment=Montage.specialize({constructor:{value:function(e){this.userAgent=e?e:global.navigator?global.navigator.userAgent:""}},_userAgent:{value:null},userAgent:{set:function(e){e=e.toLowerCase(),e!==this._userAgent&&(this._userAgent=e)},get:function(){return this._userAgent}},_device:{value:null},device:{get:function(){if(!this._device){var e=this.userAgent.match(/iphone|ipod|ipad/i);e&&e.length?this._device=e[0]:this._device=UNKNOWN}return this._device}},_supportsPointerEvents:{value:null},supportsPointerEvents:{get:function(){return"boolean"!=typeof this._supportsPointerEvents?this._supportsPointerEvents=!!(global.PointerEvent||global.MSPointerEvent&&global.navigator.msPointerEnabled):this._supportsPointerEvents}},_isIOSDevice:{value:null},isIOSDevice:{get:function(){return"boolean"!=typeof this._isIOSDevice?this._isIOSDevice=/iphone|ipad|ipod/.test(this.device):this._isIOSDevice}},_isAndroidDevice:{value:null},isAndroidDevice:{get:function(){return"boolean"!=typeof this._isAndroidDevice?this._isAndroidDevice=this.platformName===Environment.Platform.ANDROID:this._isAndroidDevice}},isCordova:{value:!!global.cordova},_isMobileDevice:{value:null},isMobileDevice:{get:function(){return"boolean"!=typeof this._isMobileDevice?this._isMobileDevice=/mobile/gi.test(this.userAgent):this._isMobileDevice}},isAndroidTablet:{get:function(){return this.isAndroidDevice&&!this.isMobileDevice}},_isStandalone:{value:null},isStandalone:{get:function(){return"boolean"!=typeof this._isStandalone?this._isStandalone=!!("standalone"in navigator&&navigator.standalone):this._isStandalone}},_platformName:{value:null},platformName:{get:function(){if("string"!=typeof this._platformName){var e=this.userAgent.match(/android|windows\sphone|windows|macintosh|linux|cros/gi);if(e&&e.length){var i=e[0];i===Environment.Platform.LINUX&&e[1]===Environment.Platform.ANDROID?i=Environment.Platform.ANDROID:i===CROS&&(i=Environment.Platform.CHROME_OS),this._platformName=i}else this.isIOSDevice?this._platformName=Environment.Platform.IOS:this._platformName=UNKNOWN}return this._platformName}},_browserVersion:{value:null},browserVersion:{get:function(){return"string"!=typeof this._browserVersion&&this._analyzeBrowser(),this._browserVersion}},_browserName:{value:null},browserName:{get:function(){return"string"!=typeof this._browserName&&this._analyzeBrowser(),this._browserName}},_isWKWebView:{value:null},isWKWebView:{get:function(){return"boolean"!=typeof this._isWKWebView?this._isWKWebView=this.isIOSDevice&&!!global.indexedDB:this._isWKWebView}},_isUIWebView:{value:null},isUIWebView:{get:function(){return"boolean"!=typeof this._isUIWebView?this._isUIWebView=!this.isWKWebView:this._isUIWebView}},_analyzeBrowser:{value:function(){var e,i=this.userAgent,n="",t="";e=i.indexOf(OPR)>-1?i.match(/(opr(?=\/))\/?\s*([\d+\.?]+)/i):i.indexOf(Environment.Browser.EDGE)>-1?i.match(/(edge(?=\/))\/?\s*([\d+\.?]+)/i):i.match(/(opera|chrome|safari|firefox|msie|trident|crios|fxios(?=\/))\/?\s*([\d+\.?]+)/i),e&&e.length>1&&(n=e[1],n===Environment.Browser.SAFARI?t=i.match(/version\/([\d+\.?]+)/i)[1]:n===Environment.Browser.CHROME||n===Environment.Browser.FIREFOX||n===FXIOS||n===MSIE||n===Environment.Browser.OPERA||n===CRIOS||n===Environment.Browser.EDGE?t=e[2]:n===TRIDENT&&(e=/\brv[ :]+(\d+)/g.exec(i),t=e&&e.length>1?e[1]:""),n===TRIDENT||n===MSIE?n=Environment.Browser.IE:n===OPR?n=Environment.Browser.OPERA:n===CRIOS?n=Environment.Browser.CHROME:n===FXIOS&&(n=Environment.Browser.FIREFOX)),this._browserName=n,this._browserVersion=t}}},{Device:{value:{IPHONE:"iphone",IPAD:"ipad",IPOD:"ipod"}},Platform:{value:{IOS:"ios",ANDROID:"android",WINDOWS_PHONE:"windows phone",MACINTOSH:"macintosh",WINDOWS:"windows",LINUX:"linux",CHROME_OS:"chrome os"}},Browser:{value:{SAFARI:"safari",FIREFOX:"firefox",CHROME:"chrome",OPERA:"opera",IE:"ie",EDGE:"edge"}}});exports.currentEnvironment=new Environment;