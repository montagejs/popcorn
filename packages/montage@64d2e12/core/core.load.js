montageDefine("64d2e12","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./extras/object","./extras/date","./extras/element","./extras/function","./extras/map","./extras/regexp","./extras/string","./extras/set","./extras/weak-map","proxy-polyfill/proxy.min","collections/map","collections/weak-map","collections/set","collections/listen/property-changes","frb","frb/parse","frb/evaluate","frb/assign","frb/bind","frb/compile-observer","frb/scope","frb/observers","./promise","./serialization/bindings"],factory:function(e,t,r){function n(e,t,r){var o=r||(t===j?R:y+t+g);return e!==Object.prototype?e.hasOwnProperty(o)?e[o]:Object.defineProperty(e,o,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(n(Object.getPrototypeOf(e),t,o))})[o]:(q.has(t)||q.set(t,{}),q.get(t))}function o(e){var t=J.get(e);return t||J.set(e,t=new h),t}function i(e,t,r){var n,a,l,c=x,s=Object.getOwnPropertyDescriptor(e,t);if(s)if(typeof s.value===O&&typeof r.value===O)for(c["delete"](s.value),n=o(s.value),a=n.values();l=a.next().value;)c["delete"](l);else{if(typeof s.get===O&&typeof r.get===O)for(c["delete"](s.get),n=o(s.get),a=n.values();l=a.next().value;)c["delete"](l);if(typeof s.set===O&&typeof r.set===O)for(c["delete"](s.set),n=o(s.set),a=n.values();l=a.next().value;)c["delete"](l)}if(n=M.get(e))for(a=n.values();l=a.next().value;)i(l,t,r)}function a(e){var t=M.get(e);return t||M.set(e,t=new h),t}function l(e,t,r,n,o,i,l){var c,s,u,p,f,d,b,h,g,y,v=global.Object,m=o,P=i,j=l;for(b=g=r?t:t.prototype;!y&&null!==g;){if(d){if(p=v.getOwnPropertyDescriptor(g,d)){if(p.hasOwnProperty("value")){f=p.value,y=!0;break}if(P&&p.hasOwnProperty("get")){f=p.get,y=!0;break}if(j&&p.hasOwnProperty("set")){f=p.set,y=!0;break}}}else for(c=n?(T[0]=n)&&T:v.getOwnPropertyNames(g),s=0;u=c[s];s++)if(p=v.getOwnPropertyDescriptor(g,u))if(f=p.value,void 0!==f&&null!==f){if(f===e||f.deprecatedFunction===e){d=u,m=!0;break}}else{if(f=p.get,void 0!==f&&null!==f&&(f===e||f.deprecatedFunction===e)){d=u,P=!0;break}if(f=p.set,void 0!==f&&null!==f&&(f===e||f.deprecatedFunction===e)){d=u,j=!0;break}}h=g,(g=v.getPrototypeOf(g))&&a(g).add(h)}return y&&typeof f===O?f:Function.noop}function c(e,t,r,n,i){if(e||t){var a=x.get(e);if(!a){var c=typeof this===O;a=l(e,c?this:this.constructor,c,t,r,n,i),a&&(x.set(e,a),o(a).add(e))}return a}}function s(){var e=s&&s.caller?s.caller:arguments.callee.caller,t=c.call(this,e);return t?t.apply(this,arguments):void 0}function u(e){var t=u&&u.caller?u.caller:arguments.callee.caller,r=c.call(this,t,e,!0,!1,!1);return r?r.bind(this):Function.noop}function p(e){var t=p&&p.caller?p.caller:arguments.callee.caller,r=c.call(this,t,e,!1,!0,!1);return r?r.bind(this):Function.noop}function f(e){var t=f&&f.caller?f.caller:arguments.callee.caller,r=c.call(this,t,e,!1,!1,!0);return r?r.bind(this):Function.noop}e("collections/shim"),e("./shim/object"),e("./shim/array"),e("./extras/object"),e("./extras/date"),e("./extras/element"),e("./extras/function"),e("./extras/map"),e("./extras/regexp"),e("./extras/string"),e("./extras/set"),e("./extras/weak-map"),e("proxy-polyfill/proxy.min");var d=e("collections/map"),b=e("collections/weak-map"),h=e("collections/set"),g="AttributeProperties",y="_",v="__proto__",m="value",P="enumerable",j="serializable",O="function",_=95,w=Array.prototype,D=Object.prototype,C=D.hasOwnProperty,I={get:void 0,set:void 0,configurable:!1,enumerable:!1},F={value:void 0,configurable:!1,enumerable:!1,writable:!1},x=new b,M=new b;if(!Object.create.name){var L=/^[\S\s]*?function\s*/,z=/[\s\(\/][\S\s]+$/;Object.defineProperty(Function.prototype,"name",{get:function(){var e="";return this===Function||this===Function.prototype.constructor?e="Function":this!==Function.prototype&&(e=(""+this).replace(L,"").replace(z,"")),e}})}var B=t.Montage=function(){},A={}.__proto__===Object.prototype,E={_montage_metadata:1,__state__:1,_hasUserDefinedConstructor:1};if(B.defineValueProperty=function ie(e,t,r,n,o,i){ie.template.value=r,ie.template.configurable=n,ie.template.enumerable=o,ie.template.writable=i,this.defineProperty(e,t,ie.template)},B.defineValueProperty.template=F,B.defineAccessorProperty=function ae(e,t,r,n,o,i){ae.template.get=r,ae.template.set=n,ae.template.configurable=o,ae.template.enumerable=i,this.defineProperty(e,t,ae.template)},B.defineAccessorProperty.template=I,F.value=!1,Object.defineProperty(B,"_hasUserDefinedConstructor",F),F.value=function(e,t){var r,n,o,i,a,l,c,s=this,u="undefined"==typeof this.specialize;if(e=e||Object.empty,t=t||Object.empty,e.constructor&&e.constructor.value?(r=e.constructor.value,r._hasUserDefinedConstructor=!0):this._hasUserDefinedConstructor?r=function(){return this["super"]()||this}:(r=function(){return this},r.name=this.name+"Specialized"),A)r.__proto__=s;else{for(o=Object.getOwnPropertyNames(s),l=0,c=o.length;l<c;l++)i=o[l],E.hasOwnProperty(i)||(a=Object.getOwnPropertyDescriptor(r,i),a&&!a.configurable||B.defineProperty(r,i,Object.getOwnPropertyDescriptor(s,i)));r.__constructorProto__=s,B.defineProperty(r,"isPrototypeOf",{value:function(e){for(var t;null!==e;){if(t=Object.getPrototypeOf(e),t===this)return!0;e=t}return!1},enumerable:!1})}if(n=Object.create(this.prototype),u){for(o=Object.getOwnPropertyNames(B),l=0,c=o.length;l<c;l++)i=o[l],a=Object.getOwnPropertyDescriptor(r,i),a&&!a.configurable||B.defineProperty(r,i,Object.getOwnPropertyDescriptor(B,i));for(o=Object.getOwnPropertyNames(B.prototype),l=0,c=o.length;l<c;l++)i=o[l],a=Object.getOwnPropertyDescriptor(r,i),a&&!a.configurable||B.defineProperty(n,i,Object.getOwnPropertyDescriptor(B.prototype,i))}return"objectDescriptor"in e&&B.defineProperty(r,"objectDescriptor",e.objectDescriptor),"blueprint"in e&&B.defineProperty(r,"blueprint",e.blueprint),"objectDescriptorModuleId"in e&&B.defineProperty(r,"objectDescriptorModuleId",e.objectDescriptorModuleId),"blueprintModuleId"in e&&B.defineProperty(r,"blueprintModuleId",e.blueprintModuleId),B.defineProperties(n,e,!0),B.defineProperties(r,t,!0),B.defineProperty(r,"__isConstructor__",{value:!0,enumerable:!1}),r.prototype=n,B.defineValueProperty(n,"constructor",r,!0,!1,!0),B.defineValueProperty(r,"constructor",r,!0,!1,!0),r},F.writable=!1,F.configurable=!0,F.enumerable=!1,Object.defineProperty(B,"specialize",F),!A){var N=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return typeof e===O&&e.__constructorProto__?e.__constructorProto__:N.apply(Object,arguments)}}var k={enumerable:!0,configurable:!0,serializable:!0},S={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},V={writable:!0,enumerable:!1,configurable:!0},R="_serializableAttributeProperties";Object.defineProperty(B.prototype,R,{enumerable:!1,configurable:!1,writable:!0,value:{}});var q=new d,J=new d;F.writable=F.configurable=F.enumerable=!1,F.value=function(e,t,r,o){if("object"!=typeof e&&typeof e!==O||null===e)throw new TypeError("Object must be an object, not '"+e+"'");var a=m in r;if(v in r)r.__proto__=a?typeof r.value===O?V:S:k;else{var l;l=a?typeof r.value===O?V:S:k;for(var c in l)C.call(l,c)&&(c in r||(r[c]=l[c]))}return C.call(r,P)||t.charCodeAt(0)!==_||(r.enumerable=!1),C.call(r,j)||(r.enumerable?r.get&&!r.set?r.serializable=!1:r.writable===!1&&(r.serializable=!1):r.serializable=!1),j in r&&(n(e,j)[t]=r.serializable),o||i(e,t,r),Object.defineProperty(e,t,r)},Object.defineProperty(B,"defineProperty",F),Object.defineProperty(B,"defineProperties",{value:function(e,t,r){if("object"!=typeof t||null===t)throw new TypeError("Properties must be an object, not '"+t+"'");for(var n,o=Object.getOwnPropertyNames(t),i=0;n=o[i];i++)"_bindingDescriptors"!==n&&this.defineProperty(e,n,t[n],r);return e}}),B.defineProperty(B,"didCreate",{value:Function.noop});var T=[];B.defineProperty(B,"super",{value:s,enumerable:!1}),B.defineProperty(B.prototype,"super",{value:s,enumerable:!1}),B.defineProperty(B,"superForValue",{value:u,enumerable:!1}),B.defineProperty(B.prototype,"superForValue",{value:u,enumerable:!1}),B.defineProperty(B,"superForGet",{value:p,enumerable:!1}),B.defineProperty(B.prototype,"superForGet",{value:p,enumerable:!1}),B.defineProperty(B,"superForSet",{value:f,enumerable:!1}),B.defineProperty(B.prototype,"superForSet",{value:f,enumerable:!1}),B.defineProperty(B,"getSerializablePropertyNames",{value:function(e){var t,r=n(e,j);if(r){t=[];for(var o in r)r[o]&&t.push(o);return t}return Array.empty}}),B.defineProperty(B,"getPropertyAttribute",{value:function(e,t,r){var o=n(e,r);if(o)return o[t]}}),B.defineProperty(B,"getPropertyAttributes",{value:function(e,t){var r,o=n(e,t);if(o){r={};for(var i in o)C.call(o,i)?r[i]=o[i]:r[i]=o[i];return r}}});var U={isInstance:{value:!0}},G={objectName:{value:"Function"},isInstance:{value:!0}};Object.defineProperty(B.prototype,"_montage_metadata",{enumerable:!1,writable:!0,value:void 0}),B.defineProperty(B,"getInfoForObject",{value:function(e){var t,r;if(C.call(e,"_montage_metadata")&&e._montage_metadata)return e._montage_metadata;if(t=e._montage_metadata||e.constructor&&e.constructor._montage_metadata||null,r=e.constructor===Function?G:U,e===Object.prototype)return Object.create(t,r);try{return e.constructor===Object?Object.defineProperty(e,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(t,r)})._montage_metadata:("_montage_metadata"in e.constructor.prototype||hasOwnProperty.call(e.constructor.prototype,"_montage_metadata")||Object.defineProperty(e.constructor.prototype,"_montage_metadata",{enumerable:!1,writable:!0,value:void 0}),(e._montage_metadata=Object.create(t,r))||e._montage_metadata)}catch(n){return e._montage_metadata=Object.create(t,r)}}}),B.defineProperty(B,"identifier",{value:null,serializable:!0}),B.defineProperty(B.prototype,"identifier",{value:null,serializable:!0}),B.defineProperty(B.prototype,"version",{value:1,serializable:!1}),B.defineProperty(B.prototype,"equals",{value:function(e){return!!e&&(this===e||this.uuid&&this.uuid===e.uuid)}}),B.defineProperty(B,"equals",{value:B.prototype.equals}),B.defineProperty(B.prototype,"callDelegateMethod",{value:function(e){var t,r=this.delegate;if(r){var n=this.identifier+e.toCapitalized();if("string"==typeof this.identifier&&typeof r[n]===O?t=r[n]:typeof r[e]===O&&(t=r[e]),t)return 2===arguments.length?t.call(r,arguments[1]):3===arguments.length?t.call(r,arguments[1],arguments[2]):4===arguments.length?t.call(r,arguments[1],arguments[2],arguments[3]):5===arguments.length?t.call(r,arguments[1],arguments[2],arguments[3],arguments[4]):(w.shift.call(arguments),t.apply(r,arguments))}}});var H=e("collections/listen/property-changes");Object.addEach(B,H.prototype),Object.addEach(B.prototype,H.prototype);var W=t.Bindings=e("frb"),X={defineBinding:{value:function(e,t,r){return W.defineBinding(this,e,t,r)}},defineBindings:{value:function(e,t){return W.defineBindings(this,e,t)}},cancelBinding:{value:function(e){return W.cancelBinding(this,e)}},cancelBindings:{value:function(){return W.cancelBindings(this)}},getBinding:{value:function(e){return W.getBinding(this,e)}},getBindings:{value:function(){return W.getBindings(this)}}};B.defineProperties(B,X),B.defineProperties(B.prototype,X);var $=e("frb/parse"),K=e("frb/evaluate"),Q=e("frb/assign"),Y=(e("frb/bind"),e("frb/compile-observer")),Z=e("frb/scope"),ee=e("frb/observers"),te=ee.autoCancelPrevious,re=function(){return this._willChangeListeners=null,this._changeListeners=null,this};Object.defineProperties(re.prototype,{_willChangeListeners:{value:null,writable:!0},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new d)}},_changeListeners:{value:null,writable:!0},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new d)}}});var ne=new b,oe={getPath:{value:function(e,t,r,n){return K(e,this,t||this,r,n)}},setPath:{value:function(e,t,r,n,o){return Q(this,e,t,r||this,n,o)}},observePath:{value:function(e,t){var r=$(e),n=Y(r);return n(te(t),new Z(this))}},addRangeAtPathChangeListener:{value:function(e,t,r,n,o,i){function a(e,n,o){if(t[r])t[r](e,n,o);else{if(!t.call)throw new Error("Can't dispatch range change to "+t);t.call(null,e,n,o)}}r=r||"handleRangeChange";var l=[];return this.addPathChangeListener(e,function(e){return e&&e.toArray&&e.addRangeChangeListener?(a(e.toArray(),l.toArray(),0),l=e,e.addRangeChangeListener(a)):(e=[],a(e,l,0),l=e,void 0)},void 0,void 0,n,o,i)}},getPathChangeDescriptors:{value:function(){return ne.has(this)||ne.set(this,new d),ne.get(this)}},getPathChangeDescriptor:{value:function(e,t,r){var n=B.getPathChangeDescriptors.call(this);return n.has(e)||n.set(e,new re),n=n.get(e),n=r?n.willChangeListeners:n.changeListeners,n.has(t)||n.set(t,{path:e,handler:t,beforeChange:r,cancel:Function.noop}),n.get(t)}},addPathChangeListener:{value:function(e,t,r,n,o,i,a){var l=this;t=t||Function.noop;var c=B.getPathChangeDescriptor.call(this,e,t,n);c.cancel();var s,u,p,f=$(e);if(t===Function.noop)p=function(t){if(u)throw new Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(e));u=!0,s=t};else if(r)p=function(n){return t[r].call(t,n,e,l)};else if(t.handlePathChange)p=function(r){return t.handlePathChange.call(t,r,e,l)};else{if(typeof t!==O)throw new Error("Can't recognize handler type: "+t+". Must be function or delegate implementing handlePathChange.");p=function(r){return t.call(l,r,e,l)}}var d=Y(f),b=new Z(this);b.beforeChange=n,b.parameters=o,b.document=i,b.components=a;var h=d(te(p),b);return c.cancel=h,u?s:h}},removePathChangeListener:{value:function(e,t,r){t=t||Function.noop;var n=B.getPathChangeDescriptors.call(this),o=r?"willChangeListeners":"changeListeners",i=n.get(e);if(!i)throw new Error("Can't find "+o+" for "+JSON.stringify(e));var a=i[o];if(!a.has(t))throw new Error("Can't find "+o+" for "+JSON.stringify(e));var l=a.get(t);l.cancel(),a["delete"](t),0===i.willChangeListeners.size&&0===i.changeListeners.size&&n["delete"](e),n.size<1&&ne["delete"](this)}},addBeforePathChangeListener:{value:function(e,t,r,n,o,i){return B.addPathChangeListener.call(this,e,t,r,!0,n,o,i)}},removeBeforePathChangeListener:{value:function(e,t,r){return B.removePathChangeListener.call(this,e,t,!0)}}};B.defineProperties(B,oe),B.defineProperties(B.prototype,oe),t._objectDescriptorModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=B.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=B.getInfoForObject(t);var r=e.moduleId,n=r.lastIndexOf("/"),o=r.lastIndexOf(".");n=n===-1?0:n+1,o=o===-1?r.length:o,o=o<n?r.length:o,B.defineProperty(t,"_objectDescriptorModuleId",{enumerable:!1,value:r.slice(0,o)+".mjson"})}return t._objectDescriptorModuleId}},t._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=B.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=B.getInfoForObject(t);var r=e.moduleId,n=r.lastIndexOf("/"),o=r.lastIndexOf(".");n=n===-1?0:n+1,o=o===-1?r.length:o,o=o<n?r.length:o,B.defineProperty(t,"_objectDescriptorModuleId",{enumerable:!1,value:r.slice(0,o)+".meta"})}return t._objectDescriptorModuleId}},t._objectDescriptorDescriptor={serializable:!1,enumerable:!1,get:function(){var r=B.getInfoForObject(this),n=r&&!r.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(n,"_objectDescriptor")||!n._objectDescriptor){var o=n.objectDescriptorModuleId||n.blueprintModuleId;if(!o)throw new TypeError("ObjectDescriptor moduleId undefined for the module '"+JSON.stringify(n)+"'");t._objectDescriptorDescriptor.ObjectDescriptorModulePromise||(t._objectDescriptorDescriptor.ObjectDescriptorModulePromise=e.async("./meta/module-object-descriptor").get("ModuleObjectDescriptor")),r=B.getInfoForObject(n),B.defineProperty(n,"_objectDescriptor",{enumerable:!1,value:t._objectDescriptorDescriptor.ObjectDescriptorModulePromise.then(function(e){return e.getObjectDescriptorWithModuleId(o,r.require)["catch"](function(t){if(t.message.indexOf("Can't XHR")!==-1)return e.createDefaultObjectDescriptorForObject(n).then(function(e){return e});throw t})})})}return n._objectDescriptor},set:function(t){var r,n=B.getInfoForObject(this),o=n&&!n.isInstance?this:this.constructor;if(null===t)r=null;else{if(typeof t.then===O)throw new TypeError("Object descriptor should not be a promise");t.objectDescriptorInstanceModule=o.objectDescriptorModule,r=e("./promise").Promise.resolve(t)}B.defineProperty(o,"_objectDescriptor",{enumerable:!1,value:r})}},t._blueprintDescriptor=t._objectDescriptorDescriptor,e("./serialization/bindings")}});