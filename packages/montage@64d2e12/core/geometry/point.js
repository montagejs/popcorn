var Montage=require("../core").Montage,Point=exports.Point=Montage.specialize({init:{enumerable:!1,value:function(e,t){return this.x=null===e?0:e,this.y=null===t?0:t,this}},x:{enumerable:!0,value:0},y:{enumerable:!0,value:0}},{interpolate:{enumerable:!1,value:function(e,t,n,o){var i,r;return i=t.x+(n.x-t.x)*e,r=t.y+(n.y-t.y)*e,o>0&&(i=Math.round(i*o)/o,r=Math.round(r*o)/o),(new exports.Point).init(i,r)}}}),_offsetForElement=function(e){var t,n,o,i,r=e.ownerDocument;if(e&&r){if(n=r.documentElement,o=r.body,i=r.defaultView,e!==o){if(t=e.getBoundingClientRect(),n.parentOf(e)){var l=n.clientTop||o.clientTop||0,f=n.clientLeft||o.clientLeft||0,u=i.pageYOffset||n.scrollTop||o.scrollTop,P=i.pageXOffset||n.scrollLeft||o.scrollLeft,a=t.top+u-l,p=t.left+P-f;return{top:a,left:p}}return{top:t.top,left:t.left}}return{top:o.offsetTop,left:o.offsetLeft}}return null},_webKitPoint=null,webkitImplementation=function(){Point.convertPointFromNodeToPage=function(e,t){return e&&"undefined"==typeof e.x?(t?(_webKitPoint.x=t.x,_webKitPoint.y=t.y):(_webKitPoint.x=0,_webKitPoint.y=0),t=webkitConvertPointFromNodeToPage(e,_webKitPoint),t?(new Point).init(t.x,t.y):null):null},Point.convertPointFromPageToNode=function(e,t){return e&&"undefined"==typeof e.x?(t?(_webKitPoint.x=t.x,_webKitPoint.y=t.y):(_webKitPoint.x=0,_webKitPoint.y=0),t=webkitConvertPointFromPageToNode(e,_webKitPoint),t?(new Point).init(t.x,t.y):null):null}},shimImplementation=function(){Point.convertPointFromNodeToPage=function(e,t){if(!e||"undefined"!=typeof e.x)return null;var n;return(n=_offsetForElement(e))?(new Point).init((t?t.x:0)+n.left,(t?t.y:0)+n.top):(new Point).init(t?t.x:0,t?t.y:0)},Point.convertPointFromPageToNode=function(e,t){if(!e||"undefined"!=typeof e.x)return null;var n;return(n=_offsetForElement(e))?(new Point).init((t?t.x:0)-n.left,(t?t.y:0)-n.top):(new Point).init(t?t.x:0,t?t.y:0)}};"undefined"!=typeof WebKitPoint&&"undefined"!=typeof webkitConvertPointFromNodeToPage?(_webKitPoint=new WebKitPoint(0,0),webkitImplementation()):shimImplementation();